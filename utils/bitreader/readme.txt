code from:https://github.com/32bitkid/bitreader